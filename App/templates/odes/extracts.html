{% extends "layout.html" %}

{% block styles %}
  <link rel='stylesheet' href='{{ url_for('static', filename='css/extracts.css') }}'>
{% endblock %}

{% block content %}
  <div class="container">
    <div>
      {% include "odes/logout-fragment.html" %}
      <ol class="breadcrumb">
        <li>
          <a href="{{ url_for('Metro-Extracts.index') }}">Metro Extracts</a>
        </li>
        <li class="active">Your Extracts</li>
      </ol>
    </div>
  </div>
  <div class="container">
    <h1 class="text-center">welcome back!</h1>
    <p class="text-center">Below are the extracts that you have requested:</p>
    <div id="extracts">
      <div class="headers">
        <span class="label">Name</span>
        <span class="label">Status</span>
        <span class="label">Created At</span>
      </div>
      {% for extract in extracts %}
        <a class="extract" href="{{ url_for('ODES.get_extract', extract_id=(extract.id or extract.odes.id)) }}">
          <!-- <div class="map" id="map-{{extract.odes.id}}"></div> -->
          <span class="info">{{extract.name or extract.wof.name or extract.id or extract.odes.id}}</span>
          <span class="info">{{extract.odes.status}}</span>
          <span class="info time">{{extract.odes.created_at}}</span>
        </a>
      {% endfor %}
    </div>
  </div>
{% endblock %}

{% block js %}
  <!-- <script src='{{ url_for('static', filename='js/extracts.js') }}'></script> -->
{% endblock %}

{% block script %}
  var inputFormat = d3.time.format.utc('%Y-%m-%dT%H:%M:%S.%LZ');
  var outputFormat = d3.time.format("%Y %B %d, at %I:%M %p");
  d3.selectAll(".time").text(function(){
    var t = d3.select(this).text();
    return outputFormat(inputFormat.parse(t));
  });
  {% for extract in extracts %}
    /* Extracts().init(
      {{ extract.odes.bbox|safe }}, 
      {{ extract.odes.id|safe }},
      "{{ url_for('static', filename='scene.yaml') }}"
    ); */
  {% endfor %}
{% endblock %}